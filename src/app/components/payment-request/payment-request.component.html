<div class="payment-request-container">
  <app-sidebar [sidebarType]="'finance'" [(open)]="sidebarOpen"></app-sidebar>
  
  <div class="main-content">
    <app-header 
      title="PAYMENT REQUEST" 
      subtitle="Finance Services/Payment Request"
      headerClass="finance"
      [showBackButton]="false"
      [(sidebarOpen)]="sidebarOpen">
    </app-header>
    
    <div class="payment-request-content">
      <div class="card-header">
        <h2>PAYMENT REQUEST</h2>
        <button class="add-new-btn" (click)="navigateToNewPaymentRequest()">
          <img src="assets/Add.svg" alt="Add" width="24" height="24" />
          ADD NEW PAYMENT REQUEST
        </button>
      </div>
      
      <div class="card-body">
        <button class="filter-btn">
          <img src="assets/Add filter.svg" alt="Add filter" width="10" height="10" style="margin-right: 6px;" /> Add filter
        </button>
        <div class="search-box">
          <img src="assets/Search here.svg" alt="Search here" width="10" height="10" class="search-icon" />
          <input type="text" placeholder="Search here" [(ngModel)]="searchTerm">
        </div>
      </div>
      
      <!-- Desktop Table -->
      <div class="table-container hide-mobile">
        <table class="payment-table">
          <thead>
            <tr>
              <th>Funding</th>
              <th>Programme</th>
              <th>Purpose</th>
              <th>Budget Amount</th>
              <th>Obligated Amount</th>
              <th>Date</th>
              <th>Description</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let request of paginatedData; let i = index" [class.striped]="i % 2 === 1">
              <td>{{ request.funding }}</td>
              <td>{{ request.programme }}</td>
              <td>{{ request.purpose }}</td>
              <td>{{ request.budgetAmount | currency:'KSH':'symbol':'1.0-0' }}</td>
              <td>{{ request.obligatedAmount | currency:'KSH':'symbol':'1.0-0' }}</td>
              <td>{{ request.date }}</td>
              <td>{{ request.description }}</td>
              <td>
                <span class="status-badge" [class]="'status-' + request.status.toLowerCase()">
                  {{ request.status }}
                </span>
              </td>
              <td class="action-cell">
                <button class="action-btn edit-btn" (click)="editRequest(request.id)">
                  <img src="assets/editlogo.svg" alt="Edit" width="16" height="16" />
                  EDIT
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <!-- Mobile Cards -->
      <div class="mobile-cards show-mobile">
        <div class="request-card" *ngFor="let request of paginatedData">
          <div class="card-header-mobile">
            <h3>{{ request.funding }}</h3>
            <span class="status-badge" [class]="'status-' + request.status.toLowerCase()">
              {{ request.status }}
            </span>
          </div>
          <div class="card-body-mobile">
            <div class="card-row">
              <span class="card-label">Programme:</span>
              <span class="card-value">{{ request.programme }}</span>
            </div>
            <div class="card-row">
              <span class="card-label">Purpose:</span>
              <span class="card-value">{{ request.purpose }}</span>
            </div>
            <div class="card-row">
              <span class="card-label">Budget Amount:</span>
              <span class="card-value">{{ request.budgetAmount | currency:'KSH':'symbol':'1.0-0' }}</span>
            </div>
            <div class="card-row">
              <span class="card-label">Obligated Amount:</span>
              <span class="card-value">{{ request.obligatedAmount | currency:'KSH':'symbol':'1.0-0' }}</span>
            </div>
            <div class="card-row">
              <span class="card-label">Date:</span>
              <span class="card-value">{{ request.date }}</span>
            </div>
            <div class="card-row">
              <span class="card-label">Description:</span>
              <span class="card-value">{{ request.description }}</span>
            </div>
          </div>
          <div class="card-actions">
            <button class="action-btn edit-btn mobile" (click)="editRequest(request.id)">
              <img src="assets/editlogo.svg" alt="Edit" width="16" height="16" />
              EDIT
            </button>
          </div>
        </div>
      </div>
      
      <!-- Pagination -->
      <div class="pagination">
        <button class="page-btn" [disabled]="currentPage === 1" (click)="previousPage()">Prev</button>
        <button *ngFor="let page of getVisiblePages()" 
                class="page-btn" 
                [class.active]="page === currentPage"
                (click)="goToPage(page)">
          {{ page }}
        </button>
        <button class="page-btn" [disabled]="currentPage === totalPages" (click)="nextPage()">Next</button>
      </div>
    </div>
    
    <app-footer></app-footer>
  </div>
</div>